#include <IRremote.h>
#include <stdarg.h>
#include <stdio.h>

const int ARRAY_SIZE = 67;
const int KHZ = 38; // 38KHz carrier frequency

String serialData;
boolean sendData;

IRsend irsend;

void setup() {
  Serial.begin(9600);
  while (! Serial);
}

void loop() {
  if (Serial.available()) {
    serialData = Serial.readString();

    // Make sure to send data with the "No line ending" option
    if (serialData.length() > 0) {
      unsigned int rawData[ARRAY_SIZE];
      sendData = true;

      if (serialData == "N") { // ON
        fillArray(rawData, 8900, 4650, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 1800, 450, 1800, 400, 1850, 400, 1800, 450, 700, 450, 1800, 450, 1800, 400, 1800, 450, 1800, 450, 1800, 450, 700, 450, 650, 450, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 1850, 400, 1800, 450, 1800, 450, 1800, 450, 1800, 400, 1850, 400);
      } else if (serialData == "F") { // OFF
        fillArray(rawData, 8900, 4650, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 750, 400, 1800, 450, 1800, 450, 1800, 450, 1800, 400, 750, 400, 1800, 450, 1800, 450, 1800, 450, 700, 400, 1850, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 1850, 400, 700, 450, 1800, 450, 1800, 400, 1850, 400, 1800, 450, 1800, 450, 1800, 450);
      } else if (serialData == "W") { // WHITE
        fillArray(rawData, 8900, 4650, 400, 700, 450, 700, 450, 700, 400, 750, 400, 700, 450, 700, 450, 700, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 1850, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 1850, 400, 1850, 400, 1800, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 1800, 400, 1850, 400, 1850, 400, 1800, 450, 1800, 450);
      } else if (serialData == "R") { // RED
        fillArray(rawData, 8950, 4600, 450, 700, 450, 650, 500, 650, 450, 700, 450, 650, 500, 650, 450, 700, 450, 650, 500, 1750, 500, 1750, 450, 1800, 450, 1800, 450, 650, 500, 1750, 450, 1800, 450, 1800, 450, 650, 500, 650, 500, 1750, 450, 700, 450, 650, 500, 650, 450, 700, 450, 650, 500, 1750, 500, 1750, 450, 700, 450, 1800, 450, 1750, 500, 1750, 500, 1750, 450, 1800, 450);
      } else if (serialData == "G") { // GREEN
        fillArray(rawData, 8950, 4600, 450, 700, 450, 700, 450, 650, 450, 700, 450, 700, 450, 650, 500, 650, 450, 700, 450, 1800, 450, 1750, 500, 1750, 450, 1800, 450, 700, 450, 1800, 450, 1750, 500, 1750, 450, 1800, 450, 700, 450, 1750, 500, 650, 450, 700, 450, 700, 450, 650, 500, 650, 450, 700, 450, 1750, 500, 650, 450, 1800, 450, 1800, 450, 1800, 450, 1750, 500, 1750, 500);
      } else if (serialData == "B") { // BLUE
        fillArray(rawData, 8950, 4600, 450, 700, 400, 750, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 1850, 400, 1800, 450, 1800, 450, 1800, 450, 700, 400, 1800, 450, 1800, 450, 1800, 450, 700, 400, 1850, 400, 1800, 450, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 1800, 400, 750, 400, 700, 450, 1800, 450, 1800, 400, 1850, 400, 1800, 450, 1800, 450);
      } else if (serialData == "O") { // ORANGE
        fillArray(rawData, 8900, 4600, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 1800, 450, 1800, 450, 1800, 450, 1800, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 750, 400, 700, 450, 700, 400, 1850, 400, 700, 450, 700, 450, 700, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 1850, 400);
      } else if (serialData == "L") { // LIME
        fillArray(rawData, 8900, 4650, 450, 650, 450, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 1800, 450, 1800, 450, 1800, 450, 1800, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 1850, 400, 700, 450, 700, 450, 1800, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 1800, 450, 1800, 450, 650, 450, 1850, 400, 1800, 450, 1800, 450, 1800, 450);
      } else if (serialData == "V") { // VIOLET
        fillArray(rawData, 8950, 4650, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 650, 500, 700, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 1850, 400, 700, 450, 1800, 450, 1800, 400, 1850, 400, 700, 450, 1800, 450, 700, 400, 1850, 400, 700, 450, 700, 450, 700, 400, 700, 450, 1800, 450, 650, 500, 1800, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 1850, 400);
      } else if (serialData == "H") { // PEACH
        fillArray(rawData, 8900, 4600, 500, 650, 450, 700, 450, 650, 500, 650, 450, 700, 450, 700, 450, 700, 400, 700, 450, 1800, 450, 1750, 500, 1800, 400, 1850, 400, 700, 400, 1850, 400, 1850, 400, 1850, 400, 750, 350, 750, 400, 1850, 400, 1850, 400, 750, 400, 700, 450, 700, 400, 700, 450, 1800, 450, 1800, 450, 700, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 1850, 400);
      } else if (serialData == "E") { // EMERALD
        fillArray(rawData, 8850, 4600, 500, 650, 450, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 1850, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 1800, 450, 700, 450, 1800, 450, 1750, 500, 650, 450, 700, 450, 700, 450, 700, 400, 700, 450, 1800, 450, 700, 400, 700, 450, 1800, 450, 1800, 450, 1800, 450, 1750, 450);
      } else if (serialData == "U") { // PURPLE
        fillArray(rawData, 8950, 4650, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 1800, 450, 1800, 400, 1850, 400, 1850, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 700, 450, 1800, 450, 1800, 450, 1800, 450, 700, 400, 700, 450, 700, 450, 700, 400, 1850, 400, 700, 450, 700, 450, 700, 400, 1850, 400, 1800, 450, 1800, 450, 1800, 450);
      } else if (serialData == "D") { // DANDELION
        fillArray(rawData, 8900, 4650, 400, 700, 400, 750, 400, 750, 400, 750, 350, 750, 400, 750, 400, 750, 350, 750, 400, 1850, 400, 1850, 400, 1800, 400, 1850, 400, 750, 400, 1850, 400, 1850, 400, 1800, 400, 750, 400, 750, 400, 750, 400, 700, 450, 1800, 400, 750, 400, 700, 450, 700, 400, 1850, 400, 1850, 400, 1850, 400, 1800, 450, 700, 400, 1850, 400, 1850, 400, 1850, 400);
      } else if (serialData == "T") { // TURQUOISE
        fillArray(rawData, 8900, 4600, 450, 650, 500, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 1800, 450, 1800, 450, 1800, 450, 1800, 450, 700, 400, 1800, 450, 1800, 450, 1800, 450, 1800, 450, 700, 400, 700, 450, 700, 450, 1800, 400, 700, 450, 700, 450, 700, 450, 650, 450, 1800, 450, 1800, 450, 1800, 450, 650, 450, 1800, 450, 1800, 450, 1800, 450);
      } else if (serialData == "M") { // MAGENTA
        fillArray(rawData, 8900, 4650, 400, 750, 400, 700, 400, 750, 400, 750, 400, 700, 450, 700, 400, 750, 400, 700, 450, 1800, 450, 1800, 400, 1850, 400, 1850, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400, 750, 400, 1800, 450, 700, 450, 700, 400, 1850, 400, 700, 450, 700, 400, 750, 400, 1800, 450, 700, 450, 1800, 450, 1800, 400, 700, 450, 1800, 450, 1800, 450, 1800, 400);
      } else if (serialData == "Y") { // YELLOW
        fillArray(rawData, 8900, 4650, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 1800, 450, 1800, 400, 1850, 400, 1800, 450, 700, 450, 1800, 400, 1800, 450, 1850, 400, 700, 450, 700, 400, 1850, 400, 700, 450, 1800, 450, 700, 450, 700, 400, 700, 450, 1800, 450, 1800, 450, 700, 400, 1800, 450, 700, 450, 1800, 450, 1750, 450, 1850, 400);
      } else if (serialData == "C") { // CYAN
        fillArray(rawData, 8900, 4650, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 1800, 450, 1800, 400, 1850, 400, 1800, 450, 700, 450, 1800, 450, 1800, 400, 1850, 400, 1800, 450, 700, 450, 1750, 500, 700, 400, 1800, 450, 700, 450, 650, 450, 750, 400, 700, 450, 1800, 450, 700, 400, 1850, 400, 700, 450, 1800, 450, 1800, 400, 1850, 400);
      } else if (serialData == "P") { // PINK
        fillArray(rawData, 8950, 4600, 450, 700, 400, 700, 450, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 1800, 450, 1800, 450, 1800, 450, 1800, 450, 700, 400, 1800, 450, 1800, 450, 1800, 450, 700, 400, 1850, 400, 1850, 400, 700, 450, 1800, 450, 650, 450, 700, 450, 700, 450, 1800, 450, 650, 450, 700, 450, 1800, 450, 700, 400, 1850, 400, 1800, 450, 1800, 450);
      } else if (serialData == "1") { // FLASH
        fillArray(rawData, 8900, 4600, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 1850, 400, 1800, 450, 1800, 450, 1800, 450, 700, 400, 1850, 400, 1800, 450, 1800, 450, 1800, 450, 1800, 400, 700, 450, 1800, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 1800, 450, 700, 450, 1800, 400, 1850, 400, 1800, 450, 1800, 450);
      } else if (serialData == "2") { // STROBE
        fillArray(rawData, 8900, 4650, 450, 700, 400, 700, 450, 700, 450, 700, 400, 750, 400, 700, 450, 700, 400, 750, 400, 1800, 450, 1800, 450, 1800, 450, 1800, 400, 700, 450, 1800, 450, 1800, 450, 1800, 450, 1750, 450, 1850, 400, 1800, 450, 1800, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 1850, 400, 1800, 450, 1800, 450, 1800, 450);
      } else if (serialData == "3") { // FADE
        fillArray(rawData, 8900, 4650, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 1800, 450, 1800, 450, 1800, 450, 1800, 400, 700, 450, 1800, 450, 1800, 450, 1800, 450, 1800, 400, 1850, 400, 700, 450, 700, 450, 1800, 400, 700, 450, 700, 450, 650, 500, 700, 400, 700, 450, 1800, 450, 1750, 500, 650, 450, 1800, 450, 1800, 450, 1800, 450);
      } else if (serialData == "4") { // SMOOTH
        fillArray(rawData, 8950, 4600, 450, 700, 450, 700, 400, 700, 450, 700, 450, 650, 450, 700, 450, 700, 450, 700, 400, 1850, 400, 1800, 450, 1800, 450, 1800, 450, 700, 400, 1850, 400, 1800, 450, 1800, 450, 1800, 450, 1800, 400, 1850, 400, 700, 450, 1800, 450, 700, 400, 750, 400, 700, 450, 700, 450, 700, 400, 700, 450, 1800, 450, 700, 400, 1850, 400, 1800, 450, 1800, 450);
      } else if (serialData == "+") { // DIM UP
        fillArray(rawData, 8950, 4600, 500, 650, 450, 650, 500, 650, 500, 650, 450, 650, 500, 650, 500, 650, 450, 650, 500, 1750, 500, 1750, 500, 1750, 500, 1750, 450, 650, 500, 1750, 500, 1750, 500, 1750, 500, 600, 500, 650, 500, 650, 450, 700, 450, 650, 500, 650, 450, 700, 450, 650, 500, 1750, 450, 1800, 450, 1800, 450, 1800, 450, 1750, 500, 1750, 500, 1750, 500, 1750, 500);
      } else if (serialData == "-") { // DIM DOWN
        fillArray(rawData, 8900, 4650, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 1800, 400, 1850, 400, 1800, 450, 1800, 450, 700, 450, 1800, 400, 1850, 400, 1800, 450, 1800, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 700, 450, 700, 450, 700, 400, 1850, 400, 1800, 450, 1800, 450, 1800, 450, 1800, 400, 1850, 400, 1850, 400);
      } else {
        sendData = false;
      }

      if (sendData) {
        irsend.sendRaw(rawData, sizeof(rawData) / sizeof(rawData[0]), KHZ);
      }
    }

    delay(1000); //1 second delay between each signal burst
  }
}

void fillArray(unsigned int rawData[], ...) {
  va_list args;
  va_start (args, rawData);  // Requires the last fixed parameter (to get the address)
  for (int x = 0; x < ARRAY_SIZE; x++) {
    rawData[x] = va_arg(args, unsigned int); // Requires the type to cast to. Increments ap to the next argument
  }
  va_end(args);
}
